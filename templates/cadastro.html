<!doctype html>
<html lang="pt-BR">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Esqueceu a senha</title>
    <link rel="icon" href="{{ url_for('static', filename='Fav/favicon-96x96.png') }}" type="image/png">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/cadastro.css') }}" />
</head>

<body>
    <main class="card" role="main" aria-labelledby="title">
        <h1 id="title">Esqueceu sua senha?</h1>
        <p class="lead">Informe o e-mail associado à sua conta. Enviaremos um link para redefinir a senha.</p>

        <div id="message" class="msg" role="status" aria-live="polite"></div>

        <!-- FORMULÁRIO ÚNICO -->
        <form id="forgotForm" novalidate>

            <label>Selecione seu tipo de acesso:</label>

            <div class="radio-group">

                <label class="radio-label">
                    <input type="radio" name="tipo" id="coordenador" value="coordenador" required>
                    Coordenador
                </label>

                <label class="radio-label">
                    <input type="radio" name="tipo" id="professor" value="professor">
                    Professor
                </label>

                <label class="radio-label">
                    <input type="radio" name="tipo" id="aluno" value="aluno">
                    Aluno
                </label>

                <label class="radio-label">
                    <input type="radio" name="tipo" id="aluno" value="aluno">
                    Responsavel
                </label>

            </div>

            <div>
                <label for="email">E-mail</label>
                <input id="email" name="email" type="email" placeholder="seu@exemplo.com" required
                    class="input-email" />
            </div>

            <button type="submit" class="btn">Enviar link de redefinição</button>

            <div class="links">
                <a class="link" href="{{ url_for('login') }}">Voltar ao login</a>
                <span class="muted">Não recebeu? Verifique a pasta de spam.</span>
            </div>
        </form>

        <small style="display:block;margin-top:14px;color:rgba(255,255,255,0.55);">
            Dica: links expiram por segurança.
        </small>
    </main>

    <script>
        const form = document.getElementById('forgotForm');
        const emailInput = document.getElementById('email');
        const message = document.getElementById('message');

        function showMessage(text, type = 'success') {
            message.className = 'msg ' + (type === 'success' ? 'success' : 'error');
            message.textContent = text;
            message.style.display = 'block';
        }

        form.addEventListener('submit', (e) => {
            e.preventDefault();

            const email = emailInput.value.trim();
            const tipo = form.querySelector('input[name="tipo"]:checked');

            if (!tipo) {
                showMessage('Selecione se você é coordenador, professor ou aluno.', 'error');
                return;
            }

            if (!email || !/^\S+@\S+\.\S+$/.test(email)) {
                showMessage('Informe um e-mail válido.', 'error');
                emailInput.focus();
                return;
            }

            showMessage(
                'Se o e-mail existir em nossa base, encaminhamos um link para redefinir a senha. Verifique sua caixa de entrada.'
            );

            form.querySelector('.btn').disabled = true;
            setTimeout(() => { form.querySelector('.btn').disabled = false; }, 7000);
        });
    </script>
</body>

</html>